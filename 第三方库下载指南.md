# 第三方库下载与配置指南

本文档列出项目中使用的所有第三方库，并提供 Windows 64位 和 Ubuntu 的下载地址及配置方法。

## 📚 第三方库列表

### 客户端 (ChatClient) 使用的库

1. **FMOD** - 音频处理库（用于语音消息录制和播放）
2. **科大讯飞语音SDK** - 语音识别和合成（可选，用于语音转文字）

### 服务器端 (ChatServer) 使用的库

1. **QtXlsx** - Excel 文件处理库（用于数据导出）

---

## 🎵 1. FMOD 音频库

### 简介
FMOD 是一个跨平台的音频引擎，用于音频播放、录制和处理。

### Windows 64位 下载

**官方下载地址：**
- 官网：https://www.fmod.com/download
- 直接下载：https://www.fmod.com/download#fmodengine
- 需要注册账号（免费）

**下载步骤：**
1. 访问 https://www.fmod.com/download
2. 注册/登录账号
3. 选择 "FMOD Engine" 下载
4. 选择版本：**FMOD Studio Programmer API** 或 **FMOD Core API**
5. 选择平台：**Windows**
6. 选择架构：**x64**

**推荐版本：** FMOD Core API 2.02.xx（稳定版本）

**下载后文件结构：**
```
fmod/
├── api/
│   ├── core/
│   │   ├── inc/          # 头文件
│   │   └── lib/
│   │       └── x64/      # Windows 64位库文件
│   │           ├── fmod.dll
│   │           ├── fmod_vc.lib
│   │           └── fmod_vc.lib
│   └── studio/
└── doc/
```

**需要的文件：**
- 头文件：`api/core/inc/fmod.h`, `fmod.hpp`
- 库文件：`api/core/lib/x64/fmod_vc.lib` (MSVC) 或 `fmod_vc.lib` (MinGW)
- 动态库：`api/core/lib/x64/fmod.dll`

**备用下载（GitHub）：**
- https://github.com/fmod/ (官方仓库，但通常不提供预编译版本)

### Ubuntu 下载

**方法一：从源码编译（推荐）**

1. 下载源码：
```bash
# 访问 https://www.fmod.com/download
# 下载 FMOD Core API Linux 版本
# 或使用 wget（需要登录后的链接）
wget https://www.fmod.com/download/fmodstudioapi20202linux.tar.gz
```

2. 解压：
```bash
tar -xzf fmodstudioapi20202linux.tar.gz
```

3. 编译：
```bash
cd fmodstudioapi20202linux
cd api/core/lib/x86_64/
# 库文件已经预编译好，直接使用即可
```

**需要的文件：**
- 头文件：`api/core/inc/fmod.h`, `fmod.hpp`
- 库文件：`api/core/lib/x86_64/libfmod.so` (动态库)
- 静态库：`api/core/lib/x86_64/libfmod.a` (可选)

**方法二：使用包管理器（不推荐，版本可能较旧）**
```bash
# Ubuntu 通常不提供 FMOD 的官方包
# 建议从官网下载
```

### 项目配置

**Windows (.pro 文件)：**
```pro
INCLUDEPATH += $$PWD/media/fmod/include
LIBS += -L$$PWD/media/fmod/libs -lfmodex

# 或者使用完整路径
# LIBS += $$PWD/media/fmod/libs/libfmodex.a
```

**Ubuntu (.pro 文件)：**
```pro
INCLUDEPATH += $$PWD/media/fmod/include
LIBS += -L$$PWD/media/fmod/libs -lfmod
```

**注意：** 运行时需要将 `fmod.dll` (Windows) 或 `libfmod.so` (Linux) 放到可执行文件同目录。

---

## 🗣️ 2. 科大讯飞语音SDK

### 简介
科大讯飞语音SDK 提供语音识别、语音合成等功能。

### Windows 64位 下载

**官方下载地址：**
- 官网：https://www.xfyun.cn/
- 开放平台：https://www.xfyun.cn/doc/
- SDK 下载：https://www.xfyun.cn/doc/sdk/语音识别SDK.html

**下载步骤：**
1. 访问 https://www.xfyun.cn/
2. 注册/登录账号
3. 进入"开放平台" → "SDK下载"
4. 选择"语音识别SDK"或"语音合成SDK"
5. 选择平台：**Windows**
6. 选择架构：**x64**

**推荐版本：** Msc SDK 最新版本

**下载后文件结构：**
```
MscSDK/
├── include/              # 头文件
│   ├── msp_cmn.h
│   ├── msp_errors.h
│   ├── msp_types.h
│   ├── qisr.h           # 语音识别
│   └── qtts.h           # 语音合成
└── libs/
    └── x64/
        └── msc.dll       # 动态库
```

**需要的文件：**
- 头文件：`include/` 目录下的所有 `.h` 文件
- 动态库：`libs/x64/msc.dll`

**注意：** 科大讯飞SDK需要申请AppID，使用前需要配置。

### Ubuntu 下载

**下载步骤：**
1. 访问 https://www.xfyun.cn/
2. 登录账号
3. 下载 Linux 版本的 SDK
4. 选择架构：**x86_64**

**下载后文件结构：**
```
MscSDK/
├── include/              # 头文件（同Windows）
└── libs/
    └── x64/
        └── libmsc.so     # Linux 动态库
```

**需要的文件：**
- 头文件：`include/` 目录下的所有 `.h` 文件
- 动态库：`libs/x64/libmsc.so`

### 项目配置

**Windows (.pro 文件)：**
```pro
INCLUDEPATH += $$PWD/media/voice/include
LIBS += -L$$PWD/media/voice/libs -lmsc
```

**Ubuntu (.pro 文件)：**
```pro
INCLUDEPATH += $$PWD/media/voice/include
LIBS += -L$$PWD/media/voice/libs -lmsc
```

**注意：** 
- 需要配置 AppID（在代码中）
- 运行时需要将 `msc.dll` (Windows) 或 `libmsc.so` (Linux) 放到可执行文件同目录

**替代方案：**
如果不需要语音识别功能，可以移除对科大讯飞SDK的依赖，只使用 Qt 的 `QAudioRecorder` 进行录音。

---

## 📊 3. QtXlsx (Qt5Xlsx)

### 简介
QtXlsx 是一个用于读写 Excel 文件的 Qt 库。

### Windows 64位 下载

**方法一：GitHub 源码编译（推荐）**

**GitHub 地址：**
- 官方仓库：https://github.com/QtExcel/QXlsx
- 直接下载：https://github.com/QtExcel/QXlsx/archive/master.zip

**编译步骤：**

1. 下载源码：
```bash
# 使用 Git
git clone https://github.com/QtExcel/QXlsx.git

# 或直接下载 ZIP
# 访问 https://github.com/QtExcel/QXlsx/archive/master.zip
```

2. 使用 qmake 编译：
```bash
cd QXlsx
qmake QXlsx.pro
mingw32-make  # MinGW
# 或
nmake          # MSVC
```

3. 安装（可选）：
```bash
mingw32-make install
```

**编译后的文件：**
- 头文件：`QXlsx/header/` 目录
- 库文件：`release/QXlsx.dll` 和 `release/libQXlsx.a`

**方法二：使用预编译版本（如果有）**

- 检查：https://github.com/QtExcel/QXlsx/releases
- 通常需要自己编译

**方法三：使用 vcpkg（如果使用）**
```bash
vcpkg install qxlsx
```

### Ubuntu 下载

**方法一：从源码编译（推荐）**

1. 安装依赖：
```bash
sudo apt-get update
sudo apt-get install qt5-default qttools5-dev-tools
```

2. 下载源码：
```bash
git clone https://github.com/QtExcel/QXlsx.git
cd QXlsx
```

3. 编译：
```bash
qmake QXlsx.pro
make
sudo make install
```

**方法二：使用包管理器（如果可用）**
```bash
# 某些发行版可能提供，但通常需要从源码编译
sudo apt-get install libqxlsx-dev  # 如果可用
```

### 项目配置

**Windows (.pro 文件)：**
```pro
# 方式1：使用编译好的库
INCLUDEPATH += $$PWD/libexcel/include
LIBS += -L$$PWD/libexcel/lib -lQt5Xlsx

# 方式2：直接包含源码（推荐）
include($$PWD/libexcel/QXlsx.pri)
```

**Ubuntu (.pro 文件)：**
```pro
# 如果已安装到系统
CONFIG += link_pkgconfig
PKGCONFIG += Qt5Xlsx

# 或使用源码
include($$PWD/libexcel/QXlsx.pri)
```

**使用源码方式（推荐）：**

1. 将 QXlsx 源码放到项目目录：
```
ChatServer/
└── libexcel/
    └── QXlsx/          # 从 GitHub 下载的源码
        ├── header/
        ├── source/
        └── QXlsx.pri
```

2. 在 .pro 文件中：
```pro
include($$PWD/libexcel/QXlsx/QXlsx.pri)
```

3. 在代码中使用：
```cpp
#include "xlsxdocument.h"
QXlsx::Document xlsx;
xlsx.write("A1", "Hello");
xlsx.saveAs("test.xlsx");
```

---

## 📦 快速下载脚本

### Windows 下载脚本

创建 `download_libs.bat`：

```batch
@echo off
echo 正在下载第三方库...

echo.
echo [1/3] 下载 FMOD...
echo 请访问: https://www.fmod.com/download
echo 下载后解压到: ChatClient\media\fmod\

echo.
echo [2/3] 下载科大讯飞SDK...
echo 请访问: https://www.xfyun.cn/doc/sdk/
echo 下载后解压到: ChatClient\media\voice\

echo.
echo [3/3] 下载 QtXlsx...
git clone https://github.com/QtExcel/QXlsx.git ChatServer\libexcel\QXlsx
if %errorlevel% neq 0 (
    echo Git 下载失败，请手动下载: https://github.com/QtExcel/QXlsx/archive/master.zip
)

echo.
echo 下载完成！
pause
```

### Ubuntu 下载脚本

创建 `download_libs.sh`：

```bash
#!/bin/bash

echo "正在下载第三方库..."

echo ""
echo "[1/3] 下载 FMOD..."
echo "请访问: https://www.fmod.com/download"
echo "下载后解压到: ChatClient/media/fmod/"

echo ""
echo "[2/3] 下载科大讯飞SDK..."
echo "请访问: https://www.xfyun.cn/doc/sdk/"
echo "下载后解压到: ChatClient/media/voice/"

echo ""
echo "[3/3] 下载 QtXlsx..."
if [ -d "ChatServer/libexcel/QXlsx" ]; then
    echo "QXlsx 已存在，跳过下载"
else
    git clone https://github.com/QtExcel/QXlsx.git ChatServer/libexcel/QXlsx
    if [ $? -ne 0 ]; then
        echo "Git 下载失败，请手动下载: https://github.com/QtExcel/QXlsx/archive/master.zip"
    fi
fi

echo ""
echo "下载完成！"
```

---

## 🔧 配置步骤总结

### Windows 64位 配置步骤

1. **FMOD：**
   - 从 https://www.fmod.com/download 下载
   - 解压到 `ChatClient/media/fmod/`
   - 复制头文件到 `fmod/include/`
   - 复制库文件到 `fmod/libs/`

2. **科大讯飞SDK：**
   - 从 https://www.xfyun.cn/ 下载
   - 解压到 `ChatClient/media/voice/`
   - 复制头文件到 `voice/include/`
   - 复制 `msc.dll` 到 `voice/libs/`

3. **QtXlsx：**
   - 从 GitHub 克隆或下载
   - 放到 `ChatServer/libexcel/QXlsx/`
   - 在 .pro 文件中包含 `QXlsx.pri`

### Ubuntu 配置步骤

1. **FMOD：**
   - 从官网下载 Linux 版本
   - 解压到 `ChatClient/media/fmod/`
   - 复制头文件和 `.so` 文件

2. **科大讯飞SDK：**
   - 从官网下载 Linux 版本
   - 解压到 `ChatClient/media/voice/`
   - 复制头文件和 `.so` 文件

3. **QtXlsx：**
   - 从 GitHub 克隆
   - 编译安装或直接使用源码

---

## ⚠️ 注意事项

### 1. 许可证
- **FMOD**：需要查看许可证，商业使用可能需要付费
- **科大讯飞SDK**：需要注册账号，可能有使用限制
- **QtXlsx**：MIT 许可证，免费使用

### 2. 版本兼容性
- 确保库版本与 Qt 版本兼容
- FMOD 和科大讯飞SDK 需要匹配的编译器版本

### 3. 运行时依赖
- Windows：需要将 `.dll` 文件放到可执行文件目录
- Ubuntu：需要将 `.so` 文件放到系统库目录或可执行文件目录

### 4. 可选依赖
- **科大讯飞SDK** 是可选的，如果不需要语音识别功能，可以移除
- **QtXlsx** 也是可选的，如果不需要 Excel 导出功能，可以移除

---

## 🔄 替代方案

### 如果不想使用第三方库

1. **FMOD 替代：**
   - 使用 Qt 的 `QAudioRecorder` 和 `QAudioPlayer`
   - 功能足够满足基本录音和播放需求

2. **科大讯飞SDK 替代：**
   - 移除语音识别功能
   - 只使用 Qt 的音频录制功能

3. **QtXlsx 替代：**
   - 使用 CSV 格式导出数据
   - 或使用其他 Excel 处理库

---

## 📝 验证安装

### 检查库是否正确配置

**Windows：**
```bash
# 检查文件是否存在
dir ChatClient\media\fmod\libs\fmodex.dll
dir ChatClient\media\voice\libs\msc.dll
dir ChatServer\libexcel\QXlsx\QXlsx.pri
```

**Ubuntu：**
```bash
# 检查文件是否存在
ls ChatClient/media/fmod/libs/libfmod.so
ls ChatClient/media/voice/libs/libmsc.so
ls ChatServer/libexcel/QXlsx/QXlsx.pri
```

### 编译测试

尝试编译项目，如果出现链接错误，检查：
1. 库文件路径是否正确
2. 库文件名是否正确
3. 编译器架构是否匹配（x64）

---

## 📞 获取帮助

如果遇到下载或配置问题：

1. **FMOD：**
   - 官方文档：https://www.fmod.com/docs/
   - 论坛：https://www.fmod.com/forum

2. **科大讯飞：**
   - 官方文档：https://www.xfyun.cn/doc/
   - 技术支持：通过官网联系

3. **QtXlsx：**
   - GitHub Issues：https://github.com/QtExcel/QXlsx/issues
   - 文档：https://github.com/QtExcel/QXlsx

---

**祝配置顺利！如有问题，请查阅相关文档或提问。**

